<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TinyMVC Documentation</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <a href="https://tinymvc.github.io" class="logo">
            <span>TinyMVC</span> <sup class="version">v1.x</sup>
        </a>
        <a href="https://github.com/tinymvc/tinymvc" class="github-link">
            <svg height="20" viewBox="0 0 16 16" width="20" style="margin-right: 5px;">
                <path fill="currentColor" fill-rule="evenodd"
                    d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                </path>
            </svg>
            GitHub
        </a>
    </header>

    <div class="main-container">
        <nav class="sidebar">
            <a href="/">Introduction</a>

            <h2>Getting Started</h2>
            <ul>
                <li><a href="/installation">Installation</a></li>
                <li><a href="/configuration">Configuration</a></li>
                <li><a href="/quick-start">Quick Start</a></li>
            </ul>

            <h2>The Basics</h2>
            <ul>
                <li><a href="/routing" class="active">Routing</a></li>
                <li><a href="/controllers">Controllers</a></li>
                <li><a href="/request">Request</a></li>
                <li><a href="/response">Response</a></li>
                <li><a href="/blade">Blade</a></li>
            </ul>

            <h2>Database</h2>
            <ul>
                <li><a href="/database">DB</a></li>
                <li><a href="/query-builder">Query Builder</a></li>
                <li><a href="/migrations">Migrations</a></li>
                <li><a href="/models">Models</a></li>
            </ul>

            <h2>Security</h2>
            <ul>
                <li><a href="/middleware">Middleware</a></li>
                <li><a href="/cors-and-csrf-protection">CORS & CSRF Protection</a></li>
                <li><a href="/authentication">Authentication</a></li>
                <li><a href="/authorization">Authorization</a></li>
            </ul>

            <h2>Features</h2>
            <ul>
                <li><a href="/container">Container</a></li>
                <li><a href="/encryption">Encryption</a></li>
                <li><a href="/queues">Queues</a></li>
                <li><a href="/events">Events</a></li>
                <li><a href="/asset-bundling">Asset Bundling (Vite)</a></li>
                <li><a href="/localization">Localization</a></li>
                <li><a href="/session">Session</a></li>
                <li><a href="/spark-cli">Spark CLI</a></li>
                <li><a href="/laravel-supports">Laravel Supports</a></li>
            </ul>

            <h2>Utilities</h2>
            <ul>
                <li><a href="/">Http (cURL)</a></li>
                <li><a href="/">Uploader</a></li>
                <li><a href="/">Paginator</a></li>
                <li><a href="/">Mail</a></li>
                <li><a href="/">Cache</a></li>
                <li><a href="/">Image</a></li>
                <li><a href="/">File Manager</a></li>
                <li><a href="/">Carbon Time</a></li>
            </ul>

            <a href="/contribution">❤️ Contribution</a>
        </nav>
        <div class="content">
            <section id="routing">
                <h2>Routing</h2>
                <p class="intro">
                    The routing system in TinyMVC is responsible for matching incoming HTTP requests to their
                    corresponding
                    handlers (closures or controller methods) and processing the response. It provides a fluent,
                    expressive
                    interface for defining routes with support for middleware, parameter binding, and route groups.
                </p>

                <h3>Basic Routing</h3>
                <p>Routes are typically defined in <code>routes/web.php</code> using URI patterns and closures or
                    controller methods:</p>

                <h4>Closure Example</h4>
                <pre><code>Route::get('foo', function (Request $request) {
    if ($request->has('name')) {
        return sprintf('Hello %s', $request->input('name'));
    }
    return 'Hello World';
});</code></pre>

                <h4>Controller Method Example</h4>
                <pre><code>Route::post('foo', [SomeController::class, 'store']);</code></pre>

                <div class="note">
                    <strong>Dependency Injection:</strong> The router automatically resolves both controller
                    dependencies
                    and route parameters through the dependency injection container.
                </div>

                <h4>Show All registered routes</h4>
                <p>To display all registered routes in your application, you can use the following command:</p>
                <pre><code>php spark route:list</code></pre>

                <h3>HTTP Method Routing</h3>
                <p>The router provides methods for all standard HTTP verbs:</p>

                <div class="method-grid">
                    <div class="method-item">
                        <h4>Basic Verbs</h4>
                        <pre><code>Route::get($uri, $callback);
Route::post($uri, $callback);
Route::put($uri, $callback);
Route::patch($uri, $callback);
Route::delete($uri, $callback);
Route::options($uri, $callback);</code></pre>
                    </div>

                    <div class="method-item">
                        <h4>Special Cases</h4>
                        <pre><code>// Match any HTTP method
Route::any($uri, $callback);

// Match specific methods
Route::match(['get', 'post'], $uri, $callback);

// Redirect routes
Route::redirect($from, $to, $status = 302);

// Resourceful routes
Route::resource($name, $controller);

// View rendering
Route::view($uri, $template);

// Group routes
Route::group($attributes, $closure);</code></pre>
                    </div>
                </div>

                <h3>Route Parameters</h3>
                <p>Routes can capture segments of the URI as parameters:</p>

                <h4>Required Parameters</h4>
                <pre><code>Route::get('user/{id}', function ($id) {
    return "User {$id}";
});</code></pre>

                <h4>Multiple Parameters</h4>
                <pre><code>Route::get('posts/{postId}/comments/{commentId}', 
    function ($postId, $commentId) {
        // Logic here
    });</code></pre>

                <div class="note">
                    <strong>Parameter Matching:</strong> Parameters automatically match alphanumeric characters,
                    hyphens, and underscores. The <code>{id}</code> parameter specifically matches numeric values.
                </div>

                <h3>Named Routes</h3>
                <p>Routes can be assigned names for easy URL generation:</p>
                <pre><code>Route::get('/profile', $callback)->name('profile');</code></pre>

                <h3>URL Generation</h3>
                <p>Generate URLs for named routes with parameters:</p>
                <pre><code>// Basic route URL
$url = route_url('profile'); // returns string
$url = route('profile'); // returns Url object

// Parameterized route URL
$url = route_url('post.comment', [
    'postId' => 1, 
    'commentId' => 2
]);</code></pre>

                <h3>Route Groups</h3>
                <p>Group routes to share common attributes:</p>
                <pre><code>Route::group([
    'middleware' => ['auth', 'role:admin'],
    'path' => '/admin',
    'name' => 'admin.'
], function() {
    Route::get('/dashboard', [AdminController::class, 'dashboard']);
    // More routes...
});</code></pre>

                <h4>Available Group Attributes</h4>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Attribute</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>middleware</code></td>
                            <td>Array of middlewares to apply to all routes</td>
                            <td><code>['auth', 'throttle']</code></td>
                        </tr>
                        <tr>
                            <td><code>path</code></td>
                            <td>Prefix for all route paths</td>
                            <td><code>'/api/v1'</code></td>
                        </tr>
                        <tr>
                            <td><code>method</code></td>
                            <td>HTTP methods to apply to all routes</td>
                            <td><code>['get', 'post']</code></td>
                        </tr>
                        <tr>
                            <td><code>name</code></td>
                            <td>Prefix for all route names</td>
                            <td><code>'api.'</code></td>
                        </tr>
                        <tr>
                            <td><code>callback</code></td>
                            <td>Controller to use for all routes</td>
                            <td><code>ApiController::class</code></td>
                        </tr>
                        <tr>
                            <td><code>template</code></td>
                            <td>View template prefix</td>
                            <td><code>'admin/'</code></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Resourceful Routing</h3>
                <p>Generate multiple routes for a resource controller:</p>
                <pre><code>Route::resource('photos', PhotoController::class, 
    name: 'photos',
    middleware: ['auth'],
    only: ['index', 'show'],
    except: ['destroy']
);</code></pre>

                <h4>Resource Route Mapping</h4>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Verb</th>
                            <th>Path</th>
                            <th>Action</th>
                            <th>Route Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>GET</td>
                            <td>/photos</td>
                            <td>index</td>
                            <td>photos.index</td>
                        </tr>
                        <tr>
                            <td>GET</td>
                            <td>/photos/create</td>
                            <td>create</td>
                            <td>photos.create</td>
                        </tr>
                        <tr>
                            <td>POST</td>
                            <td>/photos</td>
                            <td>store</td>
                            <td>photos.store</td>
                        </tr>
                        <tr>
                            <td>GET</td>
                            <td>/photos/{id}</td>
                            <td>show</td>
                            <td>photos.show</td>
                        </tr>
                        <tr>
                            <td>GET</td>
                            <td>/photos/{id}/edit</td>
                            <td>edit</td>
                            <td>photos.edit</td>
                        </tr>
                        <tr>
                            <td>PUT/PATCH</td>
                            <td>/photos/{id}</td>
                            <td>update</td>
                            <td>photos.update</td>
                        </tr>
                        <tr>
                            <td>DELETE</td>
                            <td>/photos/{id}</td>
                            <td>destroy</td>
                            <td>photos.destroy</td>
                        </tr>
                    </tbody>
                </table>

                <h3>View Routes</h3>
                <p>Routes can directly render views or Fireline templates:</p>
                <pre><code>// Regular view
Route::view('/welcome', 'welcome');

// Fireline template
Route::fireline('/dashboard', 'dashboard');</code></pre>

                <h3>Middleware</h3>
                <p>Assign middleware to routes:</p>
                <pre><code>Route::get('/admin', [AdminController::class, 'index'])
    ->middleware(['auth', 'admin']);</code></pre>

                <div class="note">
                    <strong>Middleware Groups:</strong> Middleware defined in route groups will be merged with
                    route-specific middleware, with duplicates removed.
                </div>

                <h3>Route Matching Process</h3>
                <p>When a request comes in, the router:</p>
                <ol>
                    <li>Iterates through all registered routes in the order they were defined</li>
                    <li>Checks for a match on both HTTP method and URI pattern</li>
                    <li>Extracts route parameters from the URI</li>
                    <li>Applies any route-specific middleware</li>
                    <li>Executes the route callback or renders the specified view</li>
                    <li>Returns a Response object</li>
                </ol>

                <h3>Error Handling</h3>
                <p>The router throws specific exceptions for routing errors:</p>
                <ul>
                    <li><code>RouteNotFoundException</code> - When no matching route is found</li>
                    <li><code>InvalidNamedRouteException</code> - When generating a URL for a non-existent named route
                    </li>
                </ul>
            </section>
        </div>
    </div>

    <footer>
        <div class="footer-links">
            <a href="https://github.com/tinymvc/tinymvc">GitHub</a>
            <a href="https://github.com/tinymvc/tinymvc/issues">Issues</a>
            <a href="https://github.com/tinymvc/tinymvc/discussions">Discussions</a>
            <a href="https://github.com/tinymvc/tinymvc/blob/main/LICENSE">License</a>
        </div>
        <div class="copyright">
            &copy; 2023 TinyMVC Framework by <a href="https://github.com/shahinmoyshan">Shahin Moyshan</a>.
        </div>
    </footer>
</body>

</html>